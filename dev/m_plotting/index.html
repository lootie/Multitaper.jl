<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Plotting · Multitaper.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Multitaper.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Multitaper.jl Documentation</a></li><li><a class="tocitem" href="../j_manual/">User manual</a></li><li><a class="tocitem" href="../k_univariate/">Univariate Functions</a></li><li><a class="tocitem" href="../l_multivariate/">Multivariate Functions</a></li><li><a class="tocitem" href="../lib/public/">Function index</a></li><li class="is-active"><a class="tocitem" href>Plotting</a><ul class="internal"><li><a class="tocitem" href="#Quick-synopsis-of-recipes"><span>Quick synopsis of recipes</span></a></li><li><a class="tocitem" href="#Univariate-recipes"><span>Univariate recipes</span></a></li><li><a class="tocitem" href="#Multivariate-recipes"><span>Multivariate recipes</span></a></li></ul></li><li><a class="tocitem" href="../n_examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Plotting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Plotting</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lootie/Multitaper.jl/blob/master/docs/src/m_plotting.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h1><p>For those using <code>Plots.jl</code>, we use <code>RecipesBase.jl</code> to quickly plot the output structs given by the base functions. </p><h2 id="Quick-synopsis-of-recipes"><a class="docs-heading-anchor" href="#Quick-synopsis-of-recipes">Quick synopsis of recipes</a><a id="Quick-synopsis-of-recipes-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-synopsis-of-recipes" title="Permalink"></a></h2><p>One can plot univariate structs</p><ul><li><p><code>MTSpectrum</code> structs, which are outputs of the <code>multispec</code> function. These are ordinary power spectrum estimates.</p></li><li><p><code>MTAutocorrelationFunction</code>, <code>Mtacvf</code> structs, which are outputs of the <code>mtacf</code> and <code>mtacvf</code> function. These are autocorrelation or autocovariance estimates, respectively. </p></li><li><p><code>MTCepstrum</code> structs, which are multitaper cepstra.</p></li><li><p><code>Demodulate</code> structs, which contain complex demodulates.</p></li></ul><p>And multivariate structs</p><ul><li><p><code>MTCoherence</code> structs, which are outputs of the multivariate <code>multispec</code> function. These are coherence estimates. </p></li><li><p>Outputs of coherence calculations are often given as <code>Tuple{Array{MTSpectrum{C,T,P,1},Array{MTCoherence,2},Nothing}</code>, and the corresponding recipe</p></li></ul><p>will plot all of the spectra, coherences, and phases on a grid. </p><ul><li><code>MtCrossCovarianceFunction</code> and <code>Mtccf</code> structs, which are outputs of the <code>mtccvf</code> and <code>mtccf</code> </li></ul><p>functions, respectively. These are plots of the multitaper cross-covariance function or cross-correlation function.</p><h2 id="Univariate-recipes"><a class="docs-heading-anchor" href="#Univariate-recipes">Univariate recipes</a><a id="Univariate-recipes-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate-recipes" title="Permalink"></a></h2><h3 id="Plotting-spectra"><a class="docs-heading-anchor" href="#Plotting-spectra">Plotting spectra</a><a id="Plotting-spectra-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-spectra" title="Permalink"></a></h3><p>To plot a univariate spectrum estimate, use the recipe with signature</p><pre><code class="nohighlight hljs">@recipe function plot(S::MTSpectrum; cross = true)</code></pre><p>The following arguments are necessary</p><ul><li><code>MTSpectrum</code> struct is the output of a call to <code>multispec</code> where only a single time series has been given, or two time series were given and the output desired is a  cross-spectrum.</li></ul><p>With the vanilla call to the plot recipe, one will get the power spectrum plotted on a logarithmic base 10 scale in the y-axis and appropriately labeled axes. If the jackknifed variance field (jkvar) in the <code>MTSpectrum</code> struct contains values, then 95 percent confidence intervals will be shown as shaded bands around the spectrum. If the phase field contains values, then the y-axis will say &quot;Cross-Spectrum&quot; instead of &quot;Spectrum&quot;.  </p><p>The optional keyword argument specifies</p><ul><li><code>cross</code> shows a small cross-shaped mark in the corner of the plot having width twice the bandwidth, and height equal to the expected jackknifed variance. </li></ul><h3 id="Plotting-autocorrelations"><a class="docs-heading-anchor" href="#Plotting-autocorrelations">Plotting autocorrelations</a><a id="Plotting-autocorrelations-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-autocorrelations" title="Permalink"></a></h3><p>To plot a multitaper estimate of autocorrelation, use the recipe with signature</p><pre><code class="nohighlight hljs">@recipe function acfplt(A::MTAutocorrelationFunction)</code></pre><p>The following arguments are necessary</p><ul><li><code>MTAutocorrelationFunction</code> struct is the output of a call to <code>mtacf</code> with a single time series given. </li></ul><p>The resulting plot will be a stem plot labeled as lags on the x-axis and autocorrelations on the y-axis. </p><h3 id="Plotting-autocovariances"><a class="docs-heading-anchor" href="#Plotting-autocovariances">Plotting autocovariances</a><a id="Plotting-autocovariances-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-autocovariances" title="Permalink"></a></h3><p>To plot a multitaper estimate of autocovariance, use the recipe with signature</p><pre><code class="nohighlight hljs">@recipe function acvfplt(A::MTAutocovarianceFunction)</code></pre><p>The following arguments are necessary</p><ul><li><code>MTAutocovarianceFunction</code> struct is the output of a call to <code>mt_acvf</code> with a single time series given. </li></ul><p>The resulting plot will be a stem plot labeled as lags on the x-axis and autocovariances on the y-axis. </p><h3 id="Cepstrum-plot"><a class="docs-heading-anchor" href="#Cepstrum-plot">Cepstrum plot</a><a id="Cepstrum-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Cepstrum-plot" title="Permalink"></a></h3><p>To plot the cepstrum, use the recipe with signature </p><pre><code class="nohighlight hljs">@recipe function cepsplt(A::MTCepstrum)</code></pre><p>The following arguments are necessary</p><ul><li><code>MTCepstrum</code> which is the output of a <code>mt_ceps</code> function call.</li></ul><p>The resulting plot will show the cepstrum coefficient as a stem plot in terms of lags. </p><h3 id="Demodulate-plot"><a class="docs-heading-anchor" href="#Demodulate-plot">Demodulate plot</a><a id="Demodulate-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Demodulate-plot" title="Permalink"></a></h3><p>To plot the complex demodulate, use the recipe with signature </p><pre><code class="nohighlight hljs">@recipe function demodplt(cdm::Demodulate)</code></pre><p>The following arguments are necessary</p><ul><li><code>cdm</code> which is the output of a <code>Demodulate</code> function call.</li></ul><p>The resulting plot will show the complex demoodulate in two stacked panels, one for the magnitude and one for the phase of the complex quantity. </p><h2 id="Multivariate-recipes"><a class="docs-heading-anchor" href="#Multivariate-recipes">Multivariate recipes</a><a id="Multivariate-recipes-1"></a><a class="docs-heading-anchor-permalink" href="#Multivariate-recipes" title="Permalink"></a></h2><h3 id="Coherence-plotting"><a class="docs-heading-anchor" href="#Coherence-plotting">Coherence plotting</a><a id="Coherence-plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Coherence-plotting" title="Permalink"></a></h3><p>To plot a multitaper estimate of the coherence, use</p><pre><code class="nohighlight hljs">@recipe function plot(C::MTCoherence; phase = false, sigMax = 0)</code></pre><p>The following arguments are necessary</p><ul><li><code>MTCoherence</code> which is the output of a <code>multispec</code> call with more than one time series as input and coherence as output. </li></ul><p>The resulting plot shows the magnitude squared coherences on a scale from 0 to 1, if no jackknifing has been done. If jackknifing has been done, the magnitude squared coherence is shown on a transformed scale (inverse hyperbolic tangent) and 95 percent confidence intervals will be shown as a shaded band. </p><p>The following keyword arguments can be set</p><ul><li><p><code>phase</code> when set to true produces a second subplot below the first which shows the (unwrapped) values of the phase estimate.</p></li><li><p><code>sigMax</code> is the number of significance lines to put on the plot. These lines are at (1.0 - 10^{1:sigMax}). For example, if one selects the default, namely <code>sigMax = 4</code>,</p></li></ul><p>one obtains lines at 0.9, 0.99, 0.999, 0.9999. </p><h3 id="Comparing-coherences"><a class="docs-heading-anchor" href="#Comparing-coherences">Comparing coherences</a><a id="Comparing-coherences-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-coherences" title="Permalink"></a></h3><p>To plot multiple estimates of the coherence together on the same axes for comparison,  use</p><pre><code class="nohighlight hljs">@recipe function plot(C::Matrix{MTCoherence}; phase = false, jk = false, sigMax = 0)</code></pre><p>The following arguments are necessary</p><ul><li><code>MTCoherence</code> is as above.</li></ul><p>The following keyword arguments can be set</p><ul><li><p><code>phase</code> and <code>sigMax</code> are as above.</p></li><li><p><code>jk</code> plots confidence intervals when set to true.</p></li></ul><h3 id="Coherences-and-spectra"><a class="docs-heading-anchor" href="#Coherences-and-spectra">Coherences and spectra</a><a id="Coherences-and-spectra-1"></a><a class="docs-heading-anchor-permalink" href="#Coherences-and-spectra" title="Permalink"></a></h3><p>To plot the coherences and spectra from, say, a call to <code>multispec</code> where there are two or more time series, one uses the recipe with the following signature:</p><pre><code class="nohighlight hljs">@recipe function
specCohMatrix(Spec::Tuple{Array{MTSpectrum{C,T,P},1},Array{MTCoherence,2},Nothing}; 
                                sigMax = 0) where C where T where P</code></pre><p>One obtains a plot with <span>$p\times p$</span> panels (if <span>$p$</span> is the number of time series) where spectra are shown in red on the diagonals, MSC are on the upper triagonal panels of the plot, and phases are on the lower triagonal panels of the plot. </p><p>The required input is </p><ul><li><code>Spec</code> which is of type <code>Tuple{Array{MTSpectrum{C,T,P},1},Array{MTCoherence,2},Nothing}</code>; which is the result one gets when one calls <code>multispec</code> on two or more time series. </li></ul><p>The keywork argument</p><ul><li><code>sigMax</code> is as above.</li></ul><p>!!! Note that at the time of this writing, it was impossible to not require Plots.jl as a dependency when using an advanced layoout, so some bonus plotting routines are in <code>Multitaper.jl/src/PlotsRecipes/Coherence_Plot.jl</code>. This code can be included on the fly for an even more advanced layout. The layout one gets has three axes, one is the transformed MSC, one is the MSC in units from 0 to 1, and the third axes is the significance if the true MSC were zero. </p><p>The main function in this piece of code has the following signature:</p><pre><code class="nohighlight hljs">@recipe function f(h::MTCoherence; siglines = true, msclines = true, sigMax = 4, legtext = false, 
        force_ylims = nothing, mscaxis = true, sigaxis = true, jk = true)</code></pre><p>The <code>MTCoherence</code> type input is explanatory (it is as above), but one has the additional keyword arguments as follows</p><ul><li><code>siglines</code> allows one to put a selected number of horizontal lines on the plot (specifically, <code>sigMax</code> number of lines are added)  indicating the significance of a magnitude squared coherence value under the null</li></ul><p>hypothesis that the two series have zero coherence at that frequency. </p><ul><li><p><code>msclines</code> allows one to put horizontal lines at various levels of the msc</p></li><li><p><code>sigMax</code> is the number of significance lines to put on the plot. These lines are at (1.0 - 10^{1:sigMax}). For example, if one selects the default, namely <code>sigMax = 4</code>,</p></li></ul><p>one obtains lines at 0.9, 0.99, 0.999, 0.9999. </p><ul><li><p><code>legtext</code> puts text in the legend.</p></li><li><p><code>force_ylims</code> gives the y-limits for the transformed axis, if desired. </p></li><li><p><code>mscaxis</code> when toggled to false will delete the MSC axis on the scale from 0 to 1. </p></li><li><p><code>sigaxis</code> when toggled to false will delete the significance axis.</p></li><li><p><code>jk</code> indicates whether jackknife confidence intervals will be drawn. </p></li></ul><h3 id="Cross-covariance-and-Cross-correlation-plots"><a class="docs-heading-anchor" href="#Cross-covariance-and-Cross-correlation-plots">Cross-covariance and Cross-correlation plots</a><a id="Cross-covariance-and-Cross-correlation-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Cross-covariance-and-Cross-correlation-plots" title="Permalink"></a></h3><p>The following two recipe signatures:</p><pre><code class="nohighlight hljs">@recipe function ccvfplot(A::MtCrossCovarianceFunction)</code></pre><p>and </p><pre><code class="nohighlight hljs">@recipe function ccfplot(A::MTCrossCorrelationFunction)</code></pre><p>will show either the cross-covariance estimate (if the input is of type <code>MtCrossCovarianceFunction</code>) or the cross-correlation estimate (if the input is of type <code>MTCrossCorrelationFunction</code>) as a stem plot.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lib/public/">« Function index</a><a class="docs-footer-nextpage" href="../n_examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Monday 2 May 2022 18:26">Monday 2 May 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
